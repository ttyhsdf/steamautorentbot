# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫ FunPay –∞–∫–∫–∞—É–Ω—Ç–∞ - –ó–ê–í–ï–†–®–ï–ù–û

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏:

### 1. **–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞** ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** `–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–± –∞–∫–∫–∞—É–Ω—Ç–µ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ Account.get()`

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞:

```python
def _ensure_account_initialized(self):
    """–£–±–µ–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω"""
    try:
        if not hasattr(self.funpay_account, 'is_initiated') or not self.funpay_account.is_initiated:
            logger.info("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∞–∫–∫–∞—É–Ω—Ç FunPay...")
            self.funpay_account.get()
            logger.info("–ê–∫–∫–∞—É–Ω—Ç FunPay —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ FunPay: {e}")
```

### 2. **–û—à–∏–±–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–∞ active** ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** `'int' object has no attribute 'active'`

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–∞ `active`:

```python
# –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ª–æ—Ç–∞
try:
    if hasattr(lot, 'active') and lot.active is not None:
        if isinstance(lot.active, bool):
            is_active = lot.active
        elif hasattr(lot.active, 'active'):
            is_active = lot.active.active
        else:
            # –ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —Å—á–∏—Ç–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º
            is_active = True
    else:
        # –ï—Å–ª–∏ –∞—Ç—Ä–∏–±—É—Ç active –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Å—á–∏—Ç–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º
        is_active = True
except Exception as e:
    logger.warning(f"–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ª–æ—Ç–∞: {e}")
    is_active = True
```

## üöÄ –£–ª—É—á—à–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

### üîÑ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
- **–í –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ:** `_ensure_account_initialized()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞
- **–í –º–µ—Ç–æ–¥–∞—Ö:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º API –≤—ã–∑–æ–≤–æ–º
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- **Fallback –∑–Ω–∞—á–µ–Ω–∏—è:** –£–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** Graceful handling –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π

### üìä **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```
[2024-01-01 12:00:00] INFO - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∞–∫–∫–∞—É–Ω—Ç FunPay...
[2024-01-01 12:00:01] INFO - –ê–∫–∫–∞—É–Ω—Ç FunPay —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
[2024-01-01 12:00:02] WARNING - –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ª–æ—Ç–∞: 'int' object has no attribute 'active'
```

## üéØ –ú–µ—Ç–æ–¥—ã —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏:

### 1. **`__init__()`** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```python
def __init__(self, funpay_account: Account):
    # ... –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ...
    self._ensure_account_initialized()  # ‚Üê –ù–æ–≤–æ–µ
```

### 2. **`get_all_lots()`** - –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –ª–æ—Ç–æ–≤
```python
def get_all_lots(self):
    try:
        self._ensure_account_initialized()  # ‚Üê –ù–æ–≤–æ–µ
        # ... –ø–æ–ª—É—á–µ–Ω–∏–µ –ª–æ—Ç–æ–≤ ...
```

### 3. **`get_lots_summary()`** - –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–≤–æ–¥–∫–∞
```python
def get_lots_summary(self):
    try:
        self._ensure_account_initialized()  # ‚Üê –ù–æ–≤–æ–µ
        # ... –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ active ...
```

### 4. **`raise_lots()`** - –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–¥–Ω—è—Ç–∏–µ
```python
def raise_lots(self):
    try:
        self._ensure_account_initialized()  # ‚Üê –ù–æ–≤–æ–µ
        # ... –ø–æ–¥–Ω—è—Ç–∏–µ –ª–æ—Ç–æ–≤ ...
```

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫:

### ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ `Account.get()`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–ª–∞–≥–∞ `is_initiated`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞ `hasattr()`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ `isinstance()`
- Fallback –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### ‚úÖ **Graceful degradation:**
- –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- –£–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç:

### ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚ùå `–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–± –∞–∫–∫–∞—É–Ω—Ç–µ` ‚Üí ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- ‚ùå `'int' object has no attribute 'active'` ‚Üí ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤

### ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- üîÑ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** –∞–∫–∫–∞—É–Ω—Ç–∞
- üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –≤—Å–µ—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- üìä **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—Ä–æ—Ü–µ—Å—Å–∞
- üéØ **Fallback –∑–Ω–∞—á–µ–Ω–∏—è** –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### ‚úÖ **–£–ª—É—á—à–µ–Ω–æ:**
- üöÄ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** —Ä–∞–±–æ—Ç—ã —Å FunPay API
- üîß **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- üìà **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- üõ°Ô∏è **–ó–∞—â–∏—Ç–∞** –æ—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫

## üéØ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–í—Å–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã! –¢–µ–ø–µ—Ä—å FunPay –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ:

1. **–ê–∫–∫–∞—É–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. **–ê—Ç—Ä–∏–±—É—Ç—ã –ª–æ—Ç–æ–≤** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ
3. **–û—à–∏–±–∫–∏ API** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è gracefully
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–æ–º–æ–≥–∞–µ—Ç –≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞!** üöÄ
